<div class="inscription-form">
	<h2>Nouvelle inscription</h2>

	<div class="tables">
		<section class="card">
			<header>
				<h4>Étudiants (5 derniers)</h4>
				<a routerLink="/manage" class="btn btn-sm btn-outline-primary">Ajouter</a>
			</header>
			<table class="table">
				<tr *ngFor="let student of latestStudents">
					<td>{{ student.nom }}</td>
					<td class="muted">{{ student.email }}</td>
				</tr>
				<tr *ngIf="!latestStudents.length">
					<td class="muted">Aucun étudiant.</td>
				</tr>
			</table>
		</section>

		<section class="card">
			<header>
				<h4>Cours (5 derniers)</h4>
				<a routerLink="/manage" class="btn btn-sm btn-outline-primary">Ajouter</a>
			</header>
			<table class="table">
				<tr *ngFor="let course of latestCourses">
					<td>{{ course.titre }}</td>
					<td class="muted">{{ course.professeur?.nom }}</td>
				</tr>
				<tr *ngIf="!latestCourses.length">
					<td class="muted">Aucun cours.</td>
				</tr>
			</table>
		</section>

		<section class="card">
			<header>
				<h4>Professeurs (5 derniers)</h4>
				<a routerLink="/manage" class="btn btn-sm btn-outline-primary">Ajouter</a>
			</header>
			<table class="table">
				<tr *ngFor="let prof of latestProfessors">
					<td>{{ prof.nom }}</td>
					<td class="muted">{{ prof.email }}</td>
				</tr>
				<tr *ngIf="!latestProfessors.length">
					<td class="muted">Aucun professeur.</td>
				</tr>
			</table>
		</section>
	</div>

	<div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>
	<div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

	<form [formGroup]="form" (ngSubmit)="submit()" class="form-grid">
		<label class="form-group">
			<span>Étudiant</span>
			<select formControlName="etudiantId" [disabled]="loadingStudents || submitting">
				<option value="" disabled selected>-- Sélectionner un étudiant --</option>
				<option *ngFor="let student of students" [value]="student.id">
					{{ student.nom }} ({{ student.email }})
				</option>
			</select>
			<small class="hint" *ngIf="loadingStudents">Chargement des étudiants...</small>
			<small class="error" *ngIf="form.controls.etudiantId.touched && form.controls.etudiantId.invalid">Requis</small>
		</label>

		<label class="form-group">
			<span>Cours</span>
			<select formControlName="coursId" [disabled]="loadingCourses || submitting">
				<option value="" disabled selected>-- Sélectionner un cours --</option>
				<option *ngFor="let course of courses" [value]="course.id">
					{{ course.titre }} - {{ course.professeur?.nom }}
				</option>
			</select>
			<small class="hint" *ngIf="loadingCourses">Chargement des cours...</small>
			<small class="error" *ngIf="form.controls.coursId.touched && form.controls.coursId.invalid">Requis</small>
		</label>

		<button type="submit" class="btn btn-primary" [disabled]="submitting || form.invalid">
			{{ submitting ? 'Envoi...' : 'Soumettre' }}
		</button>
	</form>
</div>
